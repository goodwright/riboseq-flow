title: "Ribo-seq"
subtitle: "Analysis results summary"
intro_text: False
report_comment: >
    This report has been generated by the <a href="https://github.com/iraiosub/riboseq-flow" target="_blank">iraiosub/riboseq-flow</a>
    analysis pipeline. For information about how to interpret these results, please see the
    <a href="https://github.com/iraiosub/riboseq-flow" target="_blank">documentation</a>.
report_header_info:
  - Contact E-mail: "ira.iosub@crick.ac.uk"
  - Application Type: "Ribo-seq"

exclude_modules:
    - 'general_stats'

# Other MultiQC config stuff here
custom_data:
  order:
    - length_filter
    - mapping
    - starting_length
    - useful_length
    - pca
    - riboseq_qc
    - ribocutter
  frame:
    parent_id: riboseq_qc
    parent_name: "Ribo-seq QC"
    parent_description: "This section contains various Ribo-seq quality control metrics."
    file_format: "tsv"
    section_name: "Frame"
    description: "Frame distribution for the 5' ends of reads in the expected length range."
    plot_type: "heatmap"
    pconfig:
      id: "frame_heatmap"
      title: "Frame"
      xcats_samples: False
      hide_zero_cats: True
  starting_length:
    parent_id: read_length
    parent_name: "Read Length"
    file_format: "tsv"
    section_name: "Input Read Length Distribution"
    description: "Length distribution for input reads (reads kept and analysed after filtering based on length). Unless the minimum length has been specified, reads shorter than 20 nt have been discarded and not inluded in this plot."
    plot_type: "linegraph"
    pconfig:
      id: "starting_length_linegraph"
      title: "Input Read Length Distribution"
      xlab: Length (nt)
      ylab: Frequency
      yDecimals: False
      color: '#1b9e77'
      logswitch: True
  useful_length:
    parent_id: read_length
    parent_name: "Read Length"
    file_format: "tsv"
    section_name: "Useful Read Length Distribution"
    description: "Length distribution for reads that uniquely map to protein-coding transcripts (useful reads)."
    plot_type: "linegraph"
    pconfig:
      id: "useful_length_linegraph"
      title: "Read Length Distribution"
      xlab: Length (nt)
      ylab: Frequency
      yDecimals: False
      logswitch: True
      color: '#1b9e77'
  region:
    parent_id: riboseq_qc
    parent_name: "Ribo-seq QC"
    parent_description: "This section contains various Ribo-seq quality control metrics."
    file_format: "tsv"
    section_name: "Region"
    description: "Distribution of 5'ends of the reads mapped uniquely to protein-coding transcripts reads across UTR and CDS regions."
    plot_type: "bargraph"
    pconfig:
      id: "region_barplot"
      title: "Region"
      cpswitch: True
      hide_zero_cats: True
  start_dist:
    parent_id: riboseq_qc
    parent_name: "Ribo-seq QC"
    parent_description: "This section contains various Ribo-seq quality control metrics."
    file_format: "tsv"
    section_name: "Distance from start codon"
    description: "Metaprofile of 5'ends of useful reads of expected length around start codons. Unless specified, the expected read length range is between 26 and 32 nt."
    plot_type: "linegraph"
    pconfig:
      id: "start_dist_linegraph"
      title: "Distance from start codon"
      xlab: Distance from start codon (nt)
      ylab: Count
      yDecimals: False
      color: '#d95f02'
  pcoding_percentage:
    parent_id: riboseq_qc
    parent_name: "Ribo-seq QC"
    parent_description: "This section contains various Ribo-seq quality control metrics."
    file_format: "tsv"
    section_name: "Protein-coding Genes Mapping Percentage"
    description: "Percentage of input reads mapping uniquely to protein-coding transcripts (useful reads). This is the proportion of reads that are useful for most downstream analyses. Each gene is represented by its longest CDS transcript by default. A higher fraction indicates better quality."
    plot_type: "bargraph"
    pconfig:
      id: "pcoding_percentage_barplot"
      title: "Reads mapping to protein-coding transcripts"
      ylab: "Percentage (%)"
      xmax: 100
      xmin: 0
      cpswitch: False
      stacking: null
      tt_percentages: False
      use_legend: False
      tt_suffix: '%'
      tt_decimals': 1
  expected_length:
    parent_id: riboseq_qc
    parent_name: "Ribo-seq QC"
    parent_description: "This section contains various Ribo-seq quality control metrics, summarised across all samples. More detailed QC metrics regarding the quality of the Ribo-seq data can be found in the sample-specific reports."
    file_format: "tsv"
    section_name: "Expected Read Length Percentage"
    description: "Percentage of uniquely mapping reads to protein-coding transcripts (useful reads) of expected length. The higher the percentage, the better. Unless specified, the expected read length range is between 26 and 32 nt."
    plot_type: "bargraph"
    pconfig:
      id: "expected_length_barplot"
      title: "Reads of expected length"
      ylab: "Percentage (%)"
      xmax: 100
      xmin: 0
      cpswitch: False
      stacking: null
      tt_percentages: False
      use_legend: False
      tt_suffix: '%'
  duplication:
    parent_id: riboseq_qc
    parent_name: "Ribo-seq QC"
    parent_description: "This section contains various Ribo-seq quality control metrics."
    file_format: "tsv"
    section_name: "Duplication"
    description: "Percentage of duplicated reads of expected length based on UMIs. Unless specified, the expected read length range is between 26 and 32 nt."
    plot_type: "bargraph"
    use_legend: False
    pconfig:
      id: "duplication_barplot"
      title: "Duplication"
      ylab: "Percentage (%)"
      xmax: 100
      xmin: 0
      cpswitch: False
      stacking: null
      tt_percentages: False
  ribocutter:
    parent_id: ribocutter
    parent_name: "Ribocutter"
    file_format: "tsv"
    section_name: "Ribocutter"
    description: "Percentage of reads targeted by guides designed by Ribocutter (50 guides by default) using two different read length thresholds. The higher the proportion targeted, the better."
    plot_type: "bargraph"
    pconfig:
      id: "ribocutter_barplot"
      title: "Ribocutter: proportion of reads targeted"
      ylab: "Percentage reads targeted (%)"
      xmax: 100
      xmin: 0
      cpswitch: False
      stacking: null
      hide_zero_cats: True
  mapping:
    parent_id: mapping
    parent_name: "Mapping"
    file_format: "tsv"
    section_name: "Mapping"
    description: "The mapping metrics for input reads (i.e. reads remaining after the Read Filtering step)."
    plot_type: "bargraph"
    pconfig:
      id: "mapping_barplot"
      title: "Mapping"
      cpswitch: True
      hide_zero_cats: True
  length_filter:
    parent_id: length_filter
    parent_name: "Read filtering"
    file_format: "tsv"
    section_name: "Read filtering"
    description: "The relative proportions of reads discarded and used as input for the analysis, based on the length threshold. If not specified, reads shorter than 20 nt are discarded. "
    plot_type: "bargraph"
    pconfig:
      id: "length_filter_barplot"
      title: "Read filtering"
      cpswitch: True
      hide_zero_cats: True
  featurecounts_pca:
    parent_id: pca
    parent_name: "PCA"
    parent_description: "This section contains plots showing the first two components from a principal component analysis on gene-level counts from FeatureCounts and P-site counts on CDS."
    section_name: "PCA: Gene-level"
    description: "PCA using rlog-normalised gene-level counts for top 500 most variable genes. These values are calculated using <a href='https://bioconductor.org/packages/release/bioc/html/DESeq2.html'>DESeq2</a> in the <a href='https://github.com/iraiosub/riboseq-flow/blob/master/bin/plot_pca.R'><code>plot_pca.R</code></a> script."
    file_format: "tsv"
    plot_type: "scatter"
    pconfig:
      id: "featurecounts_pca_scatter"
      title: ""
      xlab: "PC1"
      ylab: "PC2"
  psite_pca:
    parent_id: pca
    parent_name: "PCA"
    parent_description: "This section contains plots showing the first two components from a principal component analysis on gene-level counts from FeatureCounts and P-site counts on CDS."
    section_name: "P-site counts"
    description: "PCA using rlog-normalised P-site CDS counts for top 500 most variable CDS. These values are calculated using <a href='https://bioconductor.org/packages/release/bioc/html/DESeq2.html'>DESeq2</a> in the <a href='https://github.com/iraiosub/riboseq-flow/blob/master/bin/plot_pca.R'><code>plot_pca.R</code></a> script."
    file_format: "tsv"
    plot_type: "scatter"
    pconfig:
      id: "psite_pca_scatter"
      title: "PCA: P-sites"
      xlab: "PC1"
      ylab: "PC2"
  psite_cds_window_pca:
    parent_id: pca
    parent_name: "PCA"
    parent_description: "This section contains plots showing the first two components from a principal component analysis on gene-level counts from FeatureCounts and P-site counts on CDS."
    section_name: "P-site counts within CDS windows"
    description: "PCA using rlog-normalised P-site CDS counts over the defined CDS window (+15th codon to -10th codon by default) for top 500 most variable CDS widnows. These values are calculated using <a href='https://bioconductor.org/packages/release/bioc/html/DESeq2.html'>DESeq2</a> in the <a href='https://github.com/iraiosub/riboseq-flow/blob/master/bin/plot_pca.R'><code>plot_pca.R</code></a> script."
    file_format: "tsv"
    plot_type: "scatter"
    pconfig:
      id: "psite_pca_scatter"
      title: "PCA: P-sites within defined CDS windows"
      xlab: "PC1"
      ylab: "PC2"

sp:
  starting_length:
    fn: "starting_length_mqc.tsv"
  useful_length:
    fn: "useful_length_mqc.tsv"
  region:
    fn: "region_mqc.tsv"
  start_dist:
    fn: "start_dist_mqc.tsv"
  ribocutter:
    fn: "ribocutter_mqc.tsv"
  featurecounts_pca:
    fn: "featurecounts_pca_mqc.tsv"
  psite_pca:
    fn: "psite_pca_mqc.tsv"
  psite_cds_window_pca:
    fn: "psite_cds_window_pca_mqc.tsv"
  pcoding_percentage:
    fn: "pcoding_percentage_mqc.tsv"
  expected_length:
    fn: "expected_length_mqc.tsv"
  duplication:
    fn: "duplication_mqc.tsv"
  mapping:
    fn: "mapping_mqc.tsv"  
  length_filter:
    fn: "length_filter_mqc.tsv"  
  frame:
    fn: "frame_mqc.tsv"

module_order:
    - length_filter
    - mapping
    - read_length
    - pca
    - riboseq_qc
    - ribocutter
    - fastqc
    - bowtie2
    - star

report_section_order:
  length_filter:
    order: 1001
  mapping:
    order: 1000
  star:
    order: -1000
  read_length:
    order: 999
  pca:
    order: 998
  riboseq_qc:
    order: 997

export_plots: false