{
    "inputs": {
        "sample_options": {
            "name": "Sample options",
            "description": "Parameters relating to the sample being analysed.",
            "advanced": false,
            "properties": {
                "samplesheet": {
                    "name": "sample",
                    "type": "sample",
                    "pattern": "csv|xlsx",
                    "required": true,
                    "description": "The samples to process.",
                    "csv": {
                        "group": "sample",
                        "fastq": "fastq"
                    }
                }
            }
        },
        "genome_options": {
            "name": "Genome options",
            "description": "The genome being aligned to.",
            "advanced": false,
            "takes_genome": true,
            "properties": {
                "fasta": {
                    "name": "Genome FASTA",
                    "type": "file",
                    "pattern": "fasta|fa$",
                    "required": true,
                    "genome_file": "fasta",
                    "description": "A raw genome FASTA file."
                },
                "gtf": {
                    "name": "GTF",
                    "type": "file",
                    "pattern": "gtf",
                    "required": true,
                    "genome_file": "gtf",
                    "description": "An annotation for the genome."
                },
                "smrna_fasta": {
                    "name": "smRNA FASTA",
                    "type": "file",
                    "pattern": "fasta|fa$",
                    "required": true,
                    "genome_file": "fasta|fa$",
                    "description": "FASTA file to be mapped to before the genome file, typically containing rRNA and tRNA sequences."
                },
                "genome_index": {
                    "name": "Genome STAR index",
                    "type": "file",
                    "pattern": "",
                    "required": false,
                    "genome_output": {
                        "process": "GENERATE_GENOME_STAR_INDEX",
                        "filetype": ""
                    },
                    "description": "A genome index generated by STAR."
                },
                "smrna_index": {
                    "name": "Small RNA Bowtie index",
                    "type": "file",
                    "pattern": "",
                    "required": false,
                    "genome_output": {
                        "process": "GENERATE_BOWTIE_INDEX",
                        "filetype": ""
                    },
                    "description": "A small RNA index for pre-mapping generated by Bowtie."
                }
            }
        },
        "umi_options": {
            "name": "UMI Settings",
            "description": "Settings for dealing with UMIs",
            "advanced" : true,
            "properties": {
                "with_umi": {
                    "name": "Deduplicate based on UMIs",
                    "description": "Enable UMI-based read deduplication.",
                    "type": "boolean",
                    "default": false
                },
                "skip_umi_extract": {
                    "name": "Skip UMI Extraction",
                    "description": "Skip the UMI extraction from the read in case the UMIs have been moved to the headers in advance of the pipeline run.",
                    "type": "boolean"
                },
                "umi_extract_method": {
                    "name": "Type of UMI pattern",
                    "description": "UMI pattern to use. Can be either 'string' (default) or 'regex'.",
                    "type": "string"
                },
                "umi_pattern": {
                    "name": "UMI Tools barcode pattern",
                    "description": "The UMI barcode pattern to use if the UMI is on read 1 e.g. 'NNNNNN' indicates that the first 6 nucleotides of the read are from the UMI.",
                    "type": "string"
                },
                "umi_separator": {
                    "name": "UMI Tools barcode separator",
                    "description": "The UMI barcode separator in read name to use for UMI-based deduplication",
                    "type": "string",
                    "default": "_"
                }
            }
        },
        "read_preprocessing_options": {
            "name": "Read Preprocessing Settings",
            "description": "Settings to control read quality, adaptor trimming and read length filtering",
            "advanced" : true,
            "properties": {
                "skip_preprocessing": {
                    "name": "Skip trimming and length-filtering",
                    "description": "Skip the adapter trimming step and read length filtering step.",
                    "type": "boolean"
                },
                "adapter_threeprime": {
                    "name": "3' adaptor",
                    "description": "3' adaptor for Cutadapt trimming",
                    "type": "string",
                    "default":"AGATCGGAAGAGC"
                },
                "adapter_fiveprime": {
                    "name": "5' adaptor",
                    "description": "5' adaptor for Cutadapt trimming",
                    "type": "string"
                },
                "min_quality": {
                    "name": "Minimum score for quality trimming",
                    "description": "Cutoff value for Cutadapt trimming low-quality ends from reads",
                    "type": "number",
                    "default":20
                },
                "trim_nextseq": {
                    "name": "Nextseq quality trimming",
                    "description": "Instructs Cutadapt to apply the --nextseq-trim option, to trim based on quality, but ignoring the high quality G's. Input is the threshold PHRED score for quality trimming (eg. 20). See https://cutadapt.readthedocs.io/en/stable/guide.html#nextseq-trim for more details.",
                    "type": "number"
                },
                "min_readlength": {
                    "name": "Minimum read length",
                    "description": "Minimum read length after trimming",
                    "type": "number",
                    "default":20
                },
                "times_trimmed": {
                    "name": "Times trimmed",
                    "description": "Number of times a read will be adaptor trimmed",
                    "type": "number",
                    "default":1
                },
                "ts_trimming": {
                    "name": "Template-switch protcol trimming",
                    "description": "Enable trimming of poly-A from the 3'end of reads, and the first 3 nucleotides corresponding to rGrGrG for Template-switch libraries. If using this option, there is no need to specify the 5' and 3' adaptor sequences.",
                    "type": "boolean",
                    "default":false
                },
                "ts_adapter_threeprime": {
                    "name": "Template-switch protcol 3'end trimming",
                    "description": "Sequence to be trimmed from the 3'end of reads for Template-switch libraries. Applicable when ts_trimming is enabled (true).",
                    "type": "string",
                    "default":"A{11}"
                },
                "trim_polyG": {
                    "name": "Template-switch protcol 5'end trimming",
                    "description": "Trim the first 3 nucleotides from the 5' end corresponding to rGrGrG for Template-switch libraries. Applicable when ts_trimming is enabled (true).",
                    "type": "number",
                    "default":3
                }
            }
        },
        "premapping_options": {
            "name": "Pre-mapping Settings",
            "description": "Settings to control pre-mapping to the smRNA FASTA.",
            "advanced" : true,
            "properties": {
                "skip_premap": {
                    "name": "Skip pre-mapping",
                    "description": "Skip pre-mapping to the smRNA FASTA, typically containing rRNA and tRNA sequences.",
                    "type": "boolean",
                    "default":false
                },
                "bowtie2_args": {
                    "name": "Pseudo-aligner",
                    "description": "Specifies the command line options for bowtie2.",
                    "type": "string",
                    "default": "--norc --no-unal --very-sensitive-local -N 1"
                }
            }
        },
        "qc_options": {
            "name": "Ribo-seq Quality Control Settings",
            "description": "Settings to control generation of quality control files.",
            "advanced" : true,
            "properties": {
                "skip_qc": {
                    "name": "Skip quality control",
                    "description": "Skip generation of quality control files.",
                    "type": "boolean",
                    "default":false
                }
            }
        },
        "gene_quantification_options": {
            "name": "Gene-level Quantification Settings",
            "description": "Settings to control gene-level quantifcation from genome-aligned reads.",
            "advanced" : true,
            "properties": {
                "strandedness": {
                    "name": "Library strandedness",
                    "description": "Library strandedness for FeatureCounts gene-level quantification. Options are forward, reverse or unstranded.",
                    "type": "string",
                    "required": true
                }
            }
        },
        "psite_options": {
            "name": "P-site Identification Settings",
            "description": "Settings to control P-site identification, quantification and diagnostics",
            "advanced" : true,
            "properties": {
                "skip_psite": {
                    "name": "Skip P-site identification and quantification",
                    "description": "Skip P-site identification and generation of riboWaltz diagnotics plots",
                    "type": "boolean",
                    "default": false
                },
                "length_range": {
                    "name": "Read lengths range used for P-site identification",
                    "description": "Read lengths range used for P-site identification, using the pattern: minimum:maximum",
                    "type": "string",
                    "default": "26:31"
                },
                "psite_method": {
                    "name": "P-site identification method using riboWaltz",
                    "description": "Specifies method used for P-site offsets identification. Options are ribowaltz (default) or global_max_5end). For ribowaltz P-site offsets are defined using riboWaltz default seetings. See https://github.com/LabTranslationalArchitectomics/riboWaltz/ for more details. For global_max_5end P-site offsets are defined by the distances between the first nucleotide of the translation initiation site and the nucleotide corresponding to the global maximum of the read length-specific 5'end profiles.",
                    "type": "string",
                    "default": "ribowaltz"
                },
                "exclude_start": {
                    "name": "Number of nucleotides 3' from the start codon to be excluded from CDS P-site coverage",
                    "description": "Specifies the number of nucleotides 3' from the start codon to be excluded from CDS P-site quantification (default 42, i.e. exclude the first 14 codons)",
                    "type": "number",
                    "default": 42
                },
                "exclude_stop": {
                    "name": "Number of nucleotides 5' from the stop codon to be excluded from CDS P-site coverage",
                    "description": "Specifies the number of nucleotides 5' from the stop codon to be excluded from CDS P-site quantification (default 27, i.e. exclude the last 9 codons)",
                    "type": "number",
                    "default": 27
                }
            }
        },
        "ribocutter_options": {
            "name": "Design of sgRNA Templates Settings",
            "description": "Settings for the Design of sgRNA Templates to Deplete Unwanted Abundant Contaminants.",
            "advanced" : true,
            "properties": {
                "skip_ribocutter": {
                    "name": "Skip Design of sgRNA Templates",
                    "description": "Skip Design of sgRNA Templates using Ribocutter. See https://www.biorxiv.org/content/10.1101/2021.07.14.451473v1.full for more details.",
                    "type": "boolean",
                    "default": false
                },
                "guide_number": {
                    "name": "Number of guides",
                    "description": "Number of guides to be designed by Ribocutter for the depletion of unwanted abundant contaminants.",
                    "type": "number",
                    "default": 50
                },
                "max_reads": {
                    "name": "Maximum number of reads to be used for guide design.",
                    "description": "Maximum number of reads to be used by Ribocutter for designing guides for the depletion of unwanted abundant contaminants.",
                    "type": "number",
                    "default": 50
                },
                "min_read_length": {
                    "name": "Minimum length for reads to be used for guide design.",
                    "description": "Minimum Read Length for Ribocutter to design guides for the depletion of unwanted abundant contaminants. By default, all read lengths are considered, and additionally Ribocutter is also run on reads longer or equal to 23.",
                    "type": "number",
                    "default": 1
                }

            }
        },
        "cli_options": {
            "name": "Command Line Options",
            "description": "Provide customised command line options to specific processes",
            "advanced": true,
            "properties": {
                "star_args": {
                    "name": "Additional STAR parameters",
                    "description": "Mapping parameters for STAR mapping",
                    "type": "string"
                },
                "ribocutter_args": {
                    "name": "Additional Ribocutter parameters",
                    "description": "Mapping parameters for guide design with Ribocutter. See here for more details.",
                    "type": "string"
                }
            }
        }
    },
    "outputs": [
        {
            "name": "Genome and transcriptomic alignment bam",
            "description": "Genome and transcriptomic alignments in bam format for downstream analyses and genome browser viewing.",
            "filetype": "bam",
            "process": "DEDUPLICATE"
        },
        {
            "name": "Gene-level quantification",
            "description": "Gene count table in tsv format.",
            "filetype": "tsv",
            "process": "GET_GENE_LEVEL_COUNTS"
        },
        {
            "name": "P-sites coverage",
            "description": "P-site count table for CDS. (Note: coverage for the CDS windows excluding specified regions downstream start and upstream stop codons are also available.)",
            "filetype": "tsv",
            "process": "IDENTIFY_PSITES"
        },
        {
            "name": "Riboseq QC",
            "description": "Riboseq QC metrics extracted from FASTQ and alignment files. Per-sample PDF file with graphs showing the number of reads, proprtions of pre-mapping and uniquely mapping reads to the genome, coverage of read extremities aroud start and stop codons, frame, stratified by length, as well as duplication and fraction of reads uniquely mapping to the longest CDS isoform for each gene.",
            "filetype": "pdf",
            "process": "RIBOSEQ_QC"
        },
        {
            "name": "P-site QC",
            "description": "Diagnostic plots regarding P-site assignment",
            "filetype": "pdf",
            "process": "IDENTIFY_PSITES"
        },
        {
            "name": "PCA",
            "description": "PCA plots from gene-level counts, P-site CDS counts and P-site counts over CDS windows excluding specified regions downstream start and upstream stop codons",
            "filetype": "pdf",
            "process": "PCA"
        },
        {
            "name": "Ribocutter guides",
            "description": "Table in csv format containing guides designed for the depletion of abundant unwanted contaminants. (Note: guides designed using reads of minimim 23 length are also available.)",
            "filetype": "csv",
            "process": "RUN_RIBOCUTTER"
        },
        {
            "name": "Quality control report",
            "description": "MultiQC report read and alignment quality control metrics.",
            "filetype": "html",
            "process": "MULTIQC"
        }
    ]
}
